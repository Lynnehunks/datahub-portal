@using Microsoft.EntityFrameworkCore.Query
@using Microsoft.EntityFrameworkCore;
@inject IStringLocalizer<DataLabels> DataLocalizer
@inject NavigationManager NavigationManager
@inject IJSRuntime JsInterop
@implements IDisposable
@inject IDbContextFactory<DatahubProjectDBContext> DbFactory
@page "/projects"



<h1>@Localizer["My Projects"]</h1>
<div class="ae flex wrap">
@foreach (var p in _projects)
{
    <FACard Text="@p.ProjectDescription" NavLink="@("/project/" + p.Project_Acronym_CD)" Title="@p.ProjectName" Icon="@p.Project_Icon" />
}

</div>

@code {
    private List<Datahub_Project> _projects;
    DatahubProjectDBContext Context;
    protected override async Task OnInitializedAsync()
    {
        Context = DbFactory.CreateDbContext();
        _projects = Context.Projects.Where(p => !p.Is_Private && !string.IsNullOrWhiteSpace(p.Project_Acronym_CD) && !string.IsNullOrWhiteSpace(p.Project_Name)).Include(p => p.Users).ToList();
    }


     public void Dispose() 
    { 
        Context.Dispose();         
    }
}